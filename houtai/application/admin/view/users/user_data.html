
<style>
    .layui-table-cell {
        height: auto;
    }
    .layui-form-item .layui-input-inline{
        width: 40%;
    }
    .layui-form-item .layui-inline{
        width: 80%;
    }
    .layui-tab-content{
        padding: 0;
    }
    .layui-tab-card>.layui-tab-title{
        border: 0;
        padding: 15px;
        width: 98%;
    }
    .layui-input{
        -webkit-appearance: none;
        background-color: #fff;
        background-image: none;
        border-radius: 4px;
        border: 1px solid #dcdfe6;
        -webkit-box-sizing: border-box;
        box-sizing: border-box;
        color: #606266;
        display: inline-block;
        font-size: inherit;
        height: 40px;
        line-height: 40px;
        outline: none;
        padding: 0 15px;
        -webkit-transition: border-color .2s cubic-bezier(.645,.045,.355,1);
        transition: border-color .2s cubic-bezier(.645,.045,.355,1);
        width: 100%;
        height: 36px;
    }
</style>
<div style="padding:15px;background:#fff">
    <div class="layui-tab layui-tab-card" style="box-shadow: 0 2px 4px 0 rgba(0,0,0,.12), 0 0 6px 0 rgba(0,0,0,.04);">
        <ul class="layui-tab-title">
            <li class="layui-this">基本设置</li>
            <li>账变记录</li>
            <li>提现记录</li>
            <li>充值记录</li>
            <!--<li>银行账户</li>-->
            <!--<li>Tron地址</li>-->
        </ul>
        <div class="layui-tab-content">
            <!--基本设置-->
            <div class="layui-tab-item layui-show">
                <form class="layui-form layui-card" action="{:request()->url()}"  data-auto="false" method="post" autocomplete="off">
                    <input type="hidden" name="uid" value="{$user.id}">
                    <div class="layui-card-body">
                        <div class="layui-form-item">
                            <label class="layui-form-label">登录名</label>
                            <div class="layui-inline">
                                <div class="layui-input-inline" >
                                    <input type="text" placeholder="" value="{$user.username}" readonly autocomplete="off" class="layui-input">
                                </div>

                                <div class="layui-form-mid">上级推广码</div>
                                <div class="layui-input-inline" >
                                    <input type="text" placeholder="" value="{$user.invite_code}" readonly autocomplete="off" class="layui-input">
                                </div>
                            </div>
                        </div>
                        <div class="layui-form-item">
                            <label class="layui-form-label">新密码</label>
                            <div class="layui-inline">
                                <div class="layui-input-inline" >
                                    <input type="text" name="pwd" placeholder="不填则表示不修改" value="" autocomplete="off" class="layui-input">
                                </div>

                                <div class="layui-form-mid">取款密码</div>
                                <div class="layui-input-inline" >
                                    <input type="text" name="pwd2" placeholder="不填则表示不修改" value="" autocomplete="off" class="layui-input">
                                </div>
                            </div>
                        </div>
                        <div class="layui-form-item">
                            <label class="layui-form-label">注册时间</label>
                            <div class="layui-inline">
                                <div class="layui-input-inline" >
                                    <input type="text" placeholder="" readonly value="{$user.addtime|date='Y-m-d H:i:s'}" autocomplete="off" class="layui-input">
                                </div>

                                <div class="layui-form-mid">最后登录时间</div>
                                <div class="layui-input-inline" >
                                    <input type="text" placeholder="" readonly value="{$user.login_time|date='Y-m-d H:i:s'}" autocomplete="off" class="layui-input">
                                </div>
                            </div>
                        </div>
                        <div class="layui-form-item">
                            <label class="layui-form-label">等级</label>
                            <div class="layui-inline">
                                <div class="layui-input-inline" >
                                    <select name="level" class="layui-select"  lay-verify="">
                                        {volist name="levels" id="le"}
                                        <option value="{$le.level}" {if $user.level == $le.level}selected{/if}>{$le.name}</option>
                                        {/volist}
                                    </select>
                                </div>


                            </div>
                        </div>
                        <div class="layui-form-item">
                            <label class="layui-form-label">信用分</label>
                            <div class="layui-inline">
                                <div class="layui-input-inline" >
                                    <input type="number" name="credit" value="{$user.credit}" placeholder="" autocomplete="off" class="layui-input">
                                </div>

                                <!--<div class="layui-form-mid">whatsapp</div>-->
                                <!--<div class="layui-input-inline" >-->
                                <!--    <input type="text" name="whatsapp" value="{$user.whatsapp}" placeholder="" autocomplete="off" class="layui-input">-->
                                <!--</div>-->
                            </div>
                        </div>

                        <div class="layui-form-item">
                            <label class="layui-form-label">平台代理</label>
                            <div class="layui-inline">
                                <div class="layui-input-inline" >
                                    <input type="text" value="{$user.service}" readonly placeholder="" autocomplete="off" class="layui-input">
                                </div>
                            </div>
                        </div>

                        <!--                    <div class="layui-form-item">-->
                        <!--                        <label class="layui-form-label">email</label>-->
                        <!--                        <div class="layui-inline">-->
                        <!--                            <div class="layui-input-inline" >-->
                        <!---->
                        <!--                            </div>-->
                        <!--                        </div>-->
                        <!--                        <div class="layui-form-mid">平台代理</div>-->
                        <!--                        <div class="layui-input-inline" >-->
                        <!--                            <input type="text" value="{$user.service}" readonly placeholder="" autocomplete="off" class="layui-input">-->
                        <!--                        </div>-->
                        <!--                    </div>-->



                        <div class="layui-form-item">
                            <label class="layui-form-label">登录IP</label>
                            <div class="layui-inline">
                                <div class="layui-input-inline" >
                                    <input type="text" value="{$user.ip}" readonly placeholder="" autocomplete="off" class="layui-input">
                                </div>

                                <div class="layui-form-mid">登录地址</div>
                                <div class="layui-input-inline" >
                                    <input type="text" value="{$user.login_ip_address}" readonly placeholder="" autocomplete="off" class="layui-input">
                                </div>
                            </div>
                        </div>
                        <div class="layui-form-item">
                            <label class="layui-form-label">登录状态</label>
                            <div class="layui-inline">
                                <div class="layui-input-inline" >
                                    <input type="checkbox" lay-filter="user_status" name="status" lay-skin="switch" lay-text="ON|OFF" value="{$user.status}" {if($user.status == 1)}checked{/if}>
                                </div>

                                <div class="layui-form-mid">提款状态</div>
                                <div class="layui-input-inline" >
                                    <input type="checkbox" lay-filter="user_withdrawal_status" name="withdrawal_status" lay-skin="switch" lay-text="ON|OFF"  value="{$user.withdrawal_status}" {if($user.withdrawal_status == 1)}checked{/if}>
                                </div>
                            </div>
                        </div>
                        <div class="layui-form-item">
                            <label class="layui-form-label">备注</label>
                            <div class="layui-inline">
                                <div class="layui-input-inline" >
                                    <textarea name="remark" class="layui-textarea">{$user.remark}</textarea>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="layui-form-item text-center">
                        <button class="layui-btn layui-btn-normal edit_user_data" lay-submit lay-filter="submitForm">修改</button>
                    </div>
                </form>
            </div>
            <!--账变记录-->
            <div class="layui-tab-item">
                <div class="layui-card-header layui-anim layui-anim-fadein notselect">
                    <span class="layui-icon layui-icon-next font-s10 color-desc margin-right-5"></span>
                    <span style="color:red;">累计收入：{$rechagreCount|default=0}</span> ｜
                    <span style="color:red;">累计支出：{$depositCount|default=0}</span>

                    <div class="pull-right"></div>
                </div>
                <fieldset>
                    <legend>条件搜索</legend>
                    <form class="layui-form layui-form-pane form-search" action="{:request()->url()}" onsubmit="return false" method="get" autocomplete="off">
                        <div class="layui-form-item layui-inline">
                            <label class="layui-form-label">类型</label>
                            <div class="layui-input-inline">
                                <select name="type" id="selectList">
                                    <option value="">所有状态</option>
                                    <option value="-1">系统</option>
                                    <option value="1">充值</option>
                                    <option value="2">交易</option>
                                    <option value="3">返佣</option>
                                    <option value="4">强制交易</option>
                                    <option value="5">推广返佣</option>
                                    <option value="6">下级交易返佣</option>
                                    <option value="7">提现</option>
                                    <option value="8">提现驳回</option>
                                    <option value="21">利息宝进款</option>
                                    <option value="22">利息宝出款</option>
                                    <option value="23">利息宝返利</option>
                                    <option value="31">手动扣款</option>
                                    <option value="32">后台充值</option>
                                    <option value="33">注册奖励</option>
                                    <option value="34">免费赠送</option>
                                    <option value="35">冻结本金</option>
                                    <option value="36">解冻本金</option>
                                </select>
                            </div>
                        </div>

                        <div class="layui-form-item layui-inline">
                            <label class="layui-form-label">手机号码</label>
                            <div class="layui-input-inline">
                                <input  name="tel" value="{$Think.get.tel|default=''}" placeholder="" class="layui-input">
                            </div>
                        </div>
                        <div class="layui-form-item layui-inline">
                            <label class="layui-form-label">发生时间</label>
                            <div class="layui-input-inline">
                                <input data-date-range name="addtime" value="{$Think.get.addtime|default=''}" placeholder="" class="layui-input">
                            </div>
                        </div>

                        <div class="layui-form-item layui-inline">
                            <button class="layui-btn layui-btn-primary search" type="button"><i class="layui-icon">&#xe615;</i> 搜 索</button>
                        </div>
                        <table id="demo0" lay-filter="test1"></table>
                    </form>
                </fieldset>
            </div>
            <!--提现记录-->
            <div class="layui-tab-item">
                <div class="layui-card-header layui-anim layui-anim-fadein notselect">
                    <span class="layui-icon layui-icon-next font-s10 color-desc margin-right-5"></span>
                    <span style="color:red;">提款成功：{$withdrawal_success_amount|default=0}，转账中：{$in_transfer_amount|default=0}</span>

                    <div class="pull-right"></div>
                </div>
                <fieldset>
                    <legend>条件搜索</legend>
                    <form class="layui-form layui-form-pane form-search w_table"  action="{:request()->url()}" onsubmit="return false" method="get" autocomplete="off">
                        <div class="layui-form-item layui-inline">
                            <label class="layui-form-label">用户名称</label>
                            <div class="layui-input-inline">
                                <input name="username" value="{$Think.get.username|default=''}" placeholder="请输入用户名称"
                                       class="layui-input">
                            </div>
                        </div>
                        <div class="layui-form-item layui-inline">
                            <label class="layui-form-label">手机号</label>
                            <div class="layui-input-inline">
                                <input name="mobile" value="{$Think.get.mobile|default=''}" placeholder="请输入用户手机号"
                                       class="layui-input">
                            </div>
                        </div>
                        <div class="layui-form-item layui-inline">
                            <label class="layui-form-label">状态</label>
                            <div class="layui-input-inline">
                                <select name="status">
                                    <option value="">全部</option>
                                    <option value="1">未审核</option>
                                    <option value="2">已通过</option>
                                    <option value="3">已驳回</option>
                                    <option value="4">转账失败</option>
                                </select>
                            </div>
                        </div>
                        <div class="layui-form-item layui-inline">
                            <label class="layui-form-label">代理审核</label>
                            <div class="layui-input-inline">
                                <select name="agent_status">
                                    <option value="">全部</option>
                                    <option value="1">未审核</option>
                                    <option value="2">已通过</option>
                                    <option value="3">已驳回</option>
                                </select>
                            </div>
                        </div>
                        <div class="layui-form-item layui-inline">
                            <label class="layui-form-label">订单号</label>
                            <div class="layui-input-inline">
                                <input name="oid" value="{$Think.get.oid|default=''}" placeholder="请输入订单号" class="layui-input">
                            </div>
                        </div>
                        <div class="layui-form-item layui-inline">
                            <label class="layui-form-label">发起时间</label>
                            <div class="layui-input-inline">
                                <input data-date-range name="addtime" value="{$Think.get.addtime|default=''}" placeholder="请选择发起时间"
                                       class="layui-input">
                            </div>
                        </div>
                        <div class="layui-form-item layui-inline">
                            <button type="button" class="layui-btn layui-btn-primary w_search"><i class="layui-icon">&#xe615;</i> 搜 索</button>
                        </div>
                        <table id="demo1" lay-filter="test2"></table>
                    </form>
                </fieldset>
            </div>
            <!--充值记录-->
            <div class="layui-tab-item">
                <div class="layui-card-header layui-anim layui-anim-fadein notselect">
                    <span class="layui-icon layui-icon-next font-s10 color-desc margin-right-5"></span>
                    <span style="color:red;">支付成功：{$recharge_success_amount|default=0}，代收手续费：{$shouxu_amount|default=0}</span>

                    <div class="pull-right"></div>
                </div>

                <fieldset>
                    <legend>条件搜索</legend>
                    <form class="layui-form layui-form-pane r_table" action="{:request()->url()}" onsubmit="return false" method="get" autocomplete="off">
                        <div class="layui-form-item layui-inline">
                            <label class="layui-form-label">支付状态</label>
                            <div class="layui-input-inline">
                                <select name="status">
                                    <option value="">全部</option>
                                    <option value="1">未支付</option>
                                    <option value="2">充值成功</option>
                                    <option value="3">充值失败</option>
                                </select>
                            </div>
                        </div>
                        <div class="layui-form-item layui-inline">
                            <label class="layui-form-label">充值方式</label>
                            <div class="layui-input-inline">
                                <select name="recharge_type">
                                    <option value="-">全部</option>
                                    {foreach $pay_list as $k=>$v}
                                    <option value="{$v}">{$v}</option>
                                    {/foreach}
                                </select>
                            </div>
                        </div>

                        <div class="layui-form-item layui-inline">
                            <label class="layui-form-label">內部代理</label>
                            <div class="layui-input-inline">
                                <select name="agent_service_id">
                                    <option value="0">全部</option>
                                    {foreach $agent_service_list as $k=>$v}
                                    <option value="{$k}">{$v}</option>
                                    {/foreach}
                                </select>
                            </div>
                        </div>

                        <div class="layui-form-item layui-inline">
                            <label class="layui-form-label">订单号</label>
                            <div class="layui-input-inline">
                                <input name="oid" value="" placeholder="请输入订单号" class="layui-input">
                            </div>
                        </div>
                        <div class="layui-form-item layui-inline">
                            <label class="layui-form-label">手机号码</label>
                            <div class="layui-input-inline">
                                <input name="tel" value="" placeholder="请输入手机号码" class="layui-input">
                            </div>
                        </div>

                        <div class="layui-form-item layui-inline">
                            <label class="layui-form-label">添加时间</label>
                            <div class="layui-input-inline">
                                <input data-date-range name="addtime" value="{$Think.get.addtime|default=''}" placeholder="请选择添加时间" class="layui-input">
                            </div>
                        </div>
                        <div class="layui-form-item layui-inline">
                            <button type="button" class="layui-btn layui-btn-primary r-search"><i class="layui-icon">&#xe615;</i> 搜 索</button>
                        </div>
                    </form>
                </fieldset>
                <table id="demo3" lay-filter="test2"></table>
            </div>
            <!--银行账户-->
            <div class="layui-tab-item">
                <div class="layui-card-header layui-anim layui-anim-fadein notselect">
                    <span class="layui-btn layui-btn-sm layui-btn-normal bank_refresh">刷新</span>
                    <span class="layui-btn layui-btn-sm layui-btn-normal add_bank_btn">{:lang("添加")}
                </span>

                </div>
                <p style="color: red;margin-top: 20px;">添加、编辑、删除后点击刷新按钮生效</p>
                <table id="demo4" lay-filter="test4"></table>
            </div>
            <!--Tron地址-->
            <div class="layui-tab-item">
                <table id="demo5" lay-filter="test5"></table>
            </div>
        </div>
    </div>
</div>
<!--<script src="__ROOT__/static/plugs/layui/layui.all.js"></script>-->
<script>
    //注意：选项卡 依赖 element 模块，否则无法进行功能性操作
    layui.use('element', function(){
        var form = layui.form;
        var table = layui.table;

        $('.add_bank_btn').click(function (){
            layer.open({
                type: 2,
                title: '添加银行账户',
                shadeClose: true,
                shade: 0.8,
                area: ['70%', '70%'],
                content: "{:url('users/add_bank')}?uid={$user.id}"
            });
        })

        $('.search').click(function (){
            table.reload('demo0', {
                where: {
                    iasjax:1,
                    level:1,
                    addtime:$('input[name="addtime"]').val(),
                    tel:$('input[name="tel"]').val(),
                    type:$('#selectList').val(),
                    id:"{$user.id}"
                }
            })
        });
        //第二个搜索
        $('.w_search').click(function (){
            table.reload('demo1', {
                where: {
                    agent_status :$('.w_table select[name="agent_status"]').val(),
                    username:$('.w_table input[name="username"]').val(),
                    mobile:$('.w_table input[name="mobile"]').val(),
                    status:$('.w_table select[name="status"]').val(),
                    oid:$('.w_table input[name="oid"]').val(),
                    addtime:$('.w_table input[name="addtime"]').val(),
                    uid:"{$user.id}",
                }
            })
        })
        //第三个搜索
        $('.r-search').click(function (){
            table.reload('demo3', {
                where: {
                    tel :$('.r_table input[name="tel"]').val(),
                    oid :$('.r_table input[name="oid"]').val(),
                    agent_service_id :$('.r_table select[name="agent_service_id"]').val(),
                    recharge_type :$('.r_table select[name="recharge_type"]').val(),
                    status :$('.r_table select[name="status"]').val(),
                    oid:$('.r_table input[name="oid"]').val(),
                    addtime:$('.r_table input[name="addtime"]').val(),
                    uid:"{$user.id}",
                }
            })
        })
        //刷新银行
        $('.bank_refresh').click(function (){
            table.reload('demo4', {
                where: {
                    uid:"{$user.id}",
                }
            })
        })
        //第一个实例
        table.render({
            elem: '#demo0'
            ,where: {
                iasjax:1,
                level:1,
                addtime:"{$Think.get.addtime}",
                tel:"{$Think.get.tel}",
                type:"{$Think.get.type}",
                id:"{$user.id}"
            }
            ,height: 512
            ,totalRow: true
            ,url: '{:url("users/caiwu")}' //数据接口
            ,page: true //开启分页
            ,cols: [[ //表头
                {field: 'id', title: 'ID', width:150}
                ,{field: 'tel', title: '账号', width:150,totalRowText: '合计' }
                ,{field: 'oid', title: '订单编号', width:150,sort: true}
                ,{field: 'balance', title: '之前金额', width:150,sort: true,totalRow: true}
                ,{field: 'num', title: '金额', width:150,sort: true,totalRow: true}
                ,{field: 'zhou', title: '之后金额', width:150}
                ,{field: 'type', title: '类型', width:150}
                ,{field: 'status', title: '状态', width:150 }
                ,{field: 'addtime', title: '发生时间',width:150 }
            ]]
        });

        //第二个实例
        table.render({
            elem: '#demo1'
            ,where: {
                iasjax:1,
                agent_status:$('.w_table select[name="agent_status"]').val(),
                status:$('.w_table select[name="status"]').val(),
                oid:$('.w_table input[name="oid"]').val(),
                username:$('.w_table input[name="username"]').val(),
                mobile:$('.w_table input[name="mobile"]').val(),
                addtime:$('.w_table input[name="addtime"]').val(),
                uid:"{$user.id}",
            }
            ,height: 512
            ,totalRow: true
            ,url: '{:url("users/user_withdrawal")}' //数据接口
            ,page: true //开启分页
            ,cols: [[ //表头
                {field: 'id', title: '单号', width:180, sort: true}
                ,{field: 'tel', title: '用户名', width:160,templet:function (row) {
                        return `${row.username} <span class="layui-badge layui-bg-green">${row.is_jia == 0 ? '外部' : '内部'}</span> <br>`;
                    }}
                ,{field: 'bankname',title: '提款账户信息', width:150 ,templet:function (row) {
                        return `
                            <p>账户类型：${row.w_type} </p>
                            <p>银行名称：${row.bankname} </p>
                            <p>银行账号：${row.cardnum} </p>
                            <p>开户人：${row.khname} </p>
                            <p>手机号：${row.tel} </p>
                            <p>CCI账号：${row.bank_code} </p>
                           `;
                    }}
                ,{field: 'num', title: '申请金额', width:130,totalRow: false,templet:function (row) {
                        return `
                            ${row.num} <br>
                            手续费：${row.shouxu} <br>
                           `;
                    }}
                ,{field: 'real_num', title: '打款金额', width:130}
                ,{field: 'after_balance', title: '余额', width:150}
                ,{field: 'status', title: '状态', width:130 ,templet:function (row) {
                        //1待处理 2审核通过 3审核不通过
                        if(row.status == 1){
                            return `<span class="layui-badge layui-bg-blue">待处理</span>`;
                        }else if(row.status == 2){
                            return `<span class="layui-badge layui-bg-green">审核通过</span>`;
                        }else if(row.status == 3){
                            return `<span class="layui-badge layui-bg-red">审核不通过</span>`;
                        }
                    }}
                ,{field: 'addtime', title: '提现时间',width:150}
                ,{field: 'endtime', title: '提现时间',width:150}
                ,{title: '操作',width:200,templet:function (row) {
                        if(row.status == 1){
                            return `
                           <a class="layui-btn layui-btn-xs layui-btn-warm"
                               data-prompt="请输入驳回内容"
                               data-csrf="{:systoken('admin/deal/do_deposit')}"
                               data-action="{:url('admin/deal/do_deposit')}"
                               data-value="id#${row.id};status#3;uid#${row.uid};num#${row.num}">驳回</a>

                            <a class="layui-btn layui-btn-xs layui-btn-danger deposit_demo_apply"
                               data-confirm="确定人工通过吗?此操作不会提交到第三方"
                               data-csrf="{:systoken('admin/deal/do_deposit')}"
                               data-action="{:url('admin/deal/do_deposit')}"
                               data-value="id#${row.id};status#88">人工通过</a>
                       `;
                        }
                        return "";
                    }}
            ]]
        });

        //第三个实例
        table.render({
            elem: '#demo3'
            ,where: {
                iasjax:1,
                agent_status:$('.r_table select[name="agent_status"]').val(),
                status:$('.r_table select[name="status"]').val(),
                oid:$('.r_table input[name="oid"]').val(),
                username:$('.r_table input[name="username"]').val(),
                mobile:$('.r_table input[name="mobile"]').val(),
                addtime:$('.r_table input[name="addtime"]').val(),
                uid:"{$user.id}",
            }
            ,height: 512
            ,totalRow: true
            ,url: '{:url("users/user_recharge")}' //数据接口
            ,page: true //开启分页
            ,cols: [[ //表头
                {field: 'id', title: '商户/单号', width:250}
                ,{title: '用户名', width:250,templet:function (row) {
                        return `${row.username} <span class="layui-badge layui-bg-green">${row.is_jia == 0 ? '外部' : '内部'}</span> <br> 代理：${row.service}`;
                    }}
                ,{field: 'pay_name', title: '支付方式', width:150}
                ,{field: 'remarks',title: '付款信息', width:150}
                ,{field: 'num', title: '充值金额', width:150,totalRow: true}
                ,{field: 'status',title: '充值状态', width:150}
                ,{field: 'addtime', title: '充值时间',width:150 }
            ]]
        });

        //第四个实例
        table.render({
            elem: '#demo4'
            ,where: {
                iasjax:1,
                uid:"{$user.id}",
            }
            ,height: 512
            ,totalRow: true
            ,url: '{:url("users/user_bank_account")}' //数据接口
            ,page: true //开启分页
            ,cols: [[ //表头
                {field: 'bank_type', title: '账户类型'}
                ,{field: 'username',title: '真实姓名'}
                ,{field: 'bankname', title: '开户行'}
                ,{field: 'cardnum',title: '银行账号'}
                ,{field: 'tel',title: '手机号'}
                ,{title: '其他',totalRow: true,templet:function (row) {
                        if(!row.mailbox){
                            return '';
                        }
                        return `邮箱:${row.mailbox}  <br>`;
                    }}
                ,{title: '操作',templet:function (row) {
                        return `<span class="layui-btn layui-btn-sm layui-btn-normal edit_bank_btn" data-id="${row.id}">{:lang("编辑")}</span>
                     <span class="layui-btn layui-btn-danger layui-btn-sm del_bank_btn" data-id="${row.id}">{:lang("删除")}</span>
                    `;
                    }}
            ]]
        });

        //提交删除
        $(document).on('click','.del_bank_btn',function (){
            var id = $(this).attr('data-id');
            layer.confirm('确定删除吗？', function(index){
                $.ajax({
                    url: "{:url('users/del_bank')}",
                    data: {bid:id},
                    dataType: 'json',
                    type: 'post',
                    success: function(res){
                        layer.msg(res.info, {time: 2500})
                    }
                })
            })
        })

        $(document).on('click','.edit_bank_btn',function (){
            var id = $(this).attr('data-id');
            layer.open({
                type: 2,
                title: '编辑',
                shadeClose: true,
                shade: 0.8,
                area:  ['70%', '70%'],
                content: "{:url('users/add_bank')}"+"?b_id="+id
            });
        });

        //第五个实例
        table.render({
            elem: '#demo5'
            ,where: {
                iasjax:1,
                uid:"{$user.id}",
            }
            ,height: 512
            ,totalRow: true
            ,url: '{:url("users/user_bank_account")}?bank_type=tron' //数据接口
            ,page: true //开启分页
            ,cols: [[ //表头
                {field: 'usdt_type', title: '地址类型'}
                ,{field: 'usdt_diz',title: '钱包地址'}
                ,{field: 'addtime', title: '添加时间'}
            ]]
        });


        form.on('submit(submitForm)', function(data) {
            event.preventDefault();
            var formData = data.field;
            $.ajax({
                type: 'POST',
                url: "{:url('user_data')}",
                data: formData,
                success: function (res) {
                    layer.msg(res.info);
                    if(res.code == 1){
                        setTimeout(function () {
                            // 关闭弹窗
                            var index = parent.layer.getFrameIndex(window.name);
                            parent.layer.close(index);
                            parent.location.reload();
                        }, 2500);
                    }
                }
            });
        })

        form.on('switch(user_status)', function (data) {
            let status = data.elem.checked ? 1 : 0;
            $('input[name="status"]').val(status);
        });

        form.on('switch(user_withdrawal_status)', function (data) {
            let status = data.elem.checked ? 1 : 0;
            $('input[name="withdrawal_status"]').val(status);
        });
    });
    window.form.render();
</script>